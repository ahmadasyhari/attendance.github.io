"use strict";(self["webpackChunkresep_bunda"]=self["webpackChunkresep_bunda"]||[]).push([[838],{5838:(n,e,u)=>{u.r(e),u.d(e,{default:()=>v});var a=u(5082),t=u(124),l=u(8534),r=(u(1249),u(3710),u(2564),u(6252)),i=u(2262),o=u(3577),c=u(286),d=u(316),s=u(6100),f=u(5856),m=(0,r._)("h2",null,"Daftar Izin",-1);const p={__name:"LaporanIzin",setup:function(n){var e=(0,d.v0)(f.H),u=(0,s.ad)(f.H),p=(0,i.iH)(""),U=(0,i.iH)(""),v=(0,i.iH)(""),w=(0,i.iH)(""),k=(0,i.iH)(""),S=(0,i.iH)(""),g=(0,i.iH)(""),_=(0,i.iH)([]),W=(0,i.iH)({isOpen:!1,message:"",duration:2e3,color:"success"}),h=(0,i.iH)(!1),z=(0,i.iH)(!1),D=function(){h.value=!0},b=function(){h.value=!1},I=function(){z.value=!0},x=function(){z.value=!1},Y=function(){var n=(0,l.Z)((0,t.Z)().mark((function n(e){var a,l;return(0,t.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,s.QT)((0,s.JU)(u,"users",e));case 3:a=n.sent,a.exists()?(l=a.data(),p.value=l.fullName,U.value=l.role):(console.error("User data not found"),Z("Data pengguna tidak ditemukan","danger")),n.next=11;break;case 7:n.prev=7,n.t0=n["catch"](0),console.error("Error fetching user data:",n.t0),Z("Terjadi kesalahan saat mengambil data pengguna","danger");case 11:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(e){return n.apply(this,arguments)}}(),V=function(){var n=(0,l.Z)((0,t.Z)().mark((function n(e){var l,r;return(0,t.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return l=(0,s.IO)((0,s.hJ)(u,"izin"),(0,s.ar)("uid","==",e)),n.prev=1,n.next=4,(0,s.PL)(l);case 4:r=n.sent,_.value=r.docs.map((function(n){return(0,a.Z)({id:n.id},n.data())})),console.log("Data izin berhasil diambil:",_.value),n.next=13;break;case 9:n.prev=9,n.t0=n["catch"](1),console.error("Error fetching izin data:",n.t0),Z("Terjadi kesalahan saat mengambil data izin","danger");case 13:case"end":return n.stop()}}),n,null,[[1,9]])})));return function(e){return n.apply(this,arguments)}}(),H=function(){var n=(0,l.Z)((0,t.Z)().mark((function n(){var a,l;return(0,t.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=e.currentUser,!a){n.next=21;break}return l={uid:a.uid,fullName:p.value,role:U.value,izinStatus:v.value,durasi:w.value,keterangan:k.value,startDate:S.value?new Date(S.value):null,endDate:g.value?new Date(g.value):null,createdAt:(0,s.Bt)(),status:"pending"},n.prev=3,n.next=6,(0,s.pl)((0,s.JU)(u,"izin",a.uid+"_"+(new Date).getTime()),l);case 6:Z("Pengajuan izin berhasil diajukan","success"),v.value="",w.value="",k.value="",S.value="",g.value="",V(a.uid),n.next=19;break;case 15:n.prev=15,n.t0=n["catch"](3),console.error("Error submitting izin:",n.t0),Z("Terjadi kesalahan saat mengajukan izin","danger");case 19:n.next=23;break;case 21:console.error("User not authenticated"),Z("Pengguna tidak terautentikasi","danger");case 23:case"end":return n.stop()}}),n,null,[[3,15]])})));return function(){return n.apply(this,arguments)}}(),T=function(){var n=(0,l.Z)((0,t.Z)().mark((function n(a){var l;return(0,t.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,s.oe)((0,s.JU)(u,"izin",a));case 3:Z("Izin berhasil dibatalkan","success"),l=e.currentUser,l&&V(l.uid),n.next=12;break;case 8:n.prev=8,n.t0=n["catch"](0),console.error("Error deleting izin:",n.t0),Z("Terjadi kesalahan saat membatalkan izin","danger");case 12:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e){return n.apply(this,arguments)}}(),j=function(n){setTimeout((function(){var u=e.currentUser;u&&V(u.uid),n.target.complete()}),2e3)},Z=function(n,e){W.value={isOpen:!0,message:n,duration:2e3,color:e}},M=function(n){var e=n?n.toDate?n.toDate():new Date(n):null;return e?e.toLocaleDateString("id-ID"):"N/A"};return(0,r.bv)((function(){(0,d.Aj)(e,(function(n){n?(Y(n.uid),V(n.uid)):(console.error("User not authenticated"),Z("Pengguna tidak terautentikasi","danger"))}))})),function(n,e){return(0,r.wg)(),(0,r.j4)((0,i.SU)(c._i),null,{default:(0,r.w5)((function(){return[(0,r.Wm)((0,i.SU)(c.Gu),{mode:"ios"},{default:(0,r.w5)((function(){return[(0,r.Wm)((0,i.SU)(c.sr),null,{default:(0,r.w5)((function(){return[(0,r.Wm)((0,i.SU)(c.wd),null,{default:(0,r.w5)((function(){return[(0,r.Uk)("Pengajuan Izin")]})),_:1}),(0,r.Wm)((0,i.SU)(c.oU),{slot:"start","default-href":"/"})]})),_:1})]})),_:1}),(0,r.Wm)((0,i.SU)(c.W2),{fullscreen:!0},{default:(0,r.w5)((function(){return[(0,r.Wm)((0,i.SU)(c.nJ),{slot:"fixed",onIonRefresh:e[0]||(e[0]=function(n){return j(n)})},{default:(0,r.w5)((function(){return[(0,r.Wm)((0,i.SU)(c.Wo))]})),_:1}),(0,r.Wm)((0,i.SU)(c.W2),{class:"ion-padding"},{default:(0,r.w5)((function(){return[(0,r.Wm)((0,i.SU)(c.Ie),null,{default:(0,r.w5)((function(){return[(0,r.Wm)((0,i.SU)(c.Q$),null,{default:(0,r.w5)((function(){return[(0,r.Uk)("Nama Lengkap")]})),_:1}),(0,r.Wm)((0,i.SU)(c.pK),{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=function(n){return p.value=n}),readonly:""},null,8,["modelValue"])]})),_:1}),(0,r.Wm)((0,i.SU)(c.Ie),null,{default:(0,r.w5)((function(){return[(0,r.Wm)((0,i.SU)(c.Q$),null,{default:(0,r.w5)((function(){return[(0,r.Uk)("Role")]})),_:1}),(0,r.Wm)((0,i.SU)(c.pK),{modelValue:U.value,"onUpdate:modelValue":e[2]||(e[2]=function(n){return U.value=n}),readonly:""},null,8,["modelValue"])]})),_:1}),(0,r.Wm)((0,i.SU)(c.Ie),null,{default:(0,r.w5)((function(){return[(0,r.Wm)((0,i.SU)(c.Q$),null,{default:(0,r.w5)((function(){return[(0,r.Uk)("Status Izin")]})),_:1}),(0,r.Wm)((0,i.SU)(c.t9),{modelValue:v.value,"onUpdate:modelValue":e[3]||(e[3]=function(n){return v.value=n}),placeholder:"Pilih Status"},{default:(0,r.w5)((function(){return[(0,r.Wm)((0,i.SU)(c.n0),{value:"izin"},{default:(0,r.w5)((function(){return[(0,r.Uk)("Izin")]})),_:1}),(0,r.Wm)((0,i.SU)(c.n0),{value:"sakit"},{default:(0,r.w5)((function(){return[(0,r.Uk)("Sakit")]})),_:1})]})),_:1},8,["modelValue"])]})),_:1}),(0,r.Wm)((0,i.SU)(c.Ie),null,{default:(0,r.w5)((function(){return[(0,r.Wm)((0,i.SU)(c.Q$),null,{default:(0,r.w5)((function(){return[(0,r.Uk)("Durasi Izin (hari)")]})),_:1}),(0,r.Wm)((0,i.SU)(c.pK),{modelValue:w.value,"onUpdate:modelValue":e[4]||(e[4]=function(n){return w.value=n}),type:"number",placeholder:"Masukkan durasi izin"},null,8,["modelValue"])]})),_:1}),(0,r.Wm)((0,i.SU)(c.Ie),null,{default:(0,r.w5)((function(){return[(0,r.Wm)((0,i.SU)(c.Q$),null,{default:(0,r.w5)((function(){return[(0,r.Uk)("Dari Tanggal")]})),_:1}),(0,r.Wm)((0,i.SU)(c.YG),{expand:"block",onClick:D},{default:(0,r.w5)((function(){return[(0,r.Uk)((0,o.zw)(S.value?M(S.value):"Pilih Tanggal"),1)]})),_:1})]})),_:1}),(0,r.Wm)((0,i.SU)(c.Ie),null,{default:(0,r.w5)((function(){return[(0,r.Wm)((0,i.SU)(c.Q$),null,{default:(0,r.w5)((function(){return[(0,r.Uk)("Sampai Tanggal")]})),_:1}),(0,r.Wm)((0,i.SU)(c.YG),{expand:"block",onClick:I},{default:(0,r.w5)((function(){return[(0,r.Uk)((0,o.zw)(g.value?M(g.value):"Pilih Tanggal"),1)]})),_:1})]})),_:1}),(0,r.Wm)((0,i.SU)(c.Ie),null,{default:(0,r.w5)((function(){return[(0,r.Wm)((0,i.SU)(c.Q$),null,{default:(0,r.w5)((function(){return[(0,r.Uk)("Keterangan")]})),_:1}),(0,r.Wm)((0,i.SU)(c.g2),{modelValue:k.value,"onUpdate:modelValue":e[5]||(e[5]=function(n){return k.value=n}),placeholder:"Masukkan keterangan"},null,8,["modelValue"])]})),_:1}),(0,r.Wm)((0,i.SU)(c.YG),{expand:"block",onClick:H},{default:(0,r.w5)((function(){return[(0,r.Uk)("Ajukan Izin")]})),_:1}),(0,r.Wm)((0,i.SU)(c.jY),null,{default:(0,r.w5)((function(){return[(0,r.Wm)((0,i.SU)(c.Nd),null,{default:(0,r.w5)((function(){return[(0,r.Wm)((0,i.SU)(c.wI),null,{default:(0,r.w5)((function(){return[m,(0,r.Wm)((0,i.SU)(c.q_),null,{default:(0,r.w5)((function(){return[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(_.value,(function(n){return(0,r.wg)(),(0,r.j4)((0,i.SU)(c.Ie),{key:n.id},{default:(0,r.w5)((function(){return[(0,r.Wm)((0,i.SU)(c.Q$),null,{default:(0,r.w5)((function(){return[(0,r._)("h3",null,(0,o.zw)(n.fullName)+" - "+(0,o.zw)(n.role),1),(0,r._)("p",null,"Status: "+(0,o.zw)(n.izinStatus),1),(0,r._)("p",null,"Durasi: "+(0,o.zw)(n.durasi)+" hari",1),(0,r._)("p",null,"Keterangan: "+(0,o.zw)(n.keterangan),1),(0,r._)("p",null,"Status Admin: "+(0,o.zw)(n.status),1),(0,r._)("p",null,"Dari: "+(0,o.zw)(M(n.startDate)),1),(0,r._)("p",null,"Sampai: "+(0,o.zw)(M(n.endDate)),1),(0,r._)("p",null,"Tanggal: "+(0,o.zw)(M(n.createdAt)),1)]})),_:2},1024),(0,r.Wm)((0,i.SU)(c.YG),{color:"danger",onClick:function(e){return T(n.id)}},{default:(0,r.w5)((function(){return[(0,r.Uk)("Batalkan Izin")]})),_:2},1032,["onClick"])]})),_:2},1024)})),128))]})),_:1})]})),_:1})]})),_:1})]})),_:1})]})),_:1}),(0,r.Wm)((0,i.SU)(c.ki),{"is-open":h.value,onIonModalDidDismiss:b},{default:(0,r.w5)((function(){return[(0,r.Wm)((0,i.SU)(c.W2),null,{default:(0,r.w5)((function(){return[(0,r.Wm)((0,i.SU)(c.x4),{"display-format":"DD/MM/YYYY","picker-format":"DD/MM/YYYY",modelValue:S.value,"onUpdate:modelValue":e[6]||(e[6]=function(n){return S.value=n}),onIonChange:b},null,8,["modelValue"]),(0,r.Wm)((0,i.SU)(c.YG),{expand:"block",onClick:b},{default:(0,r.w5)((function(){return[(0,r.Uk)("Tutup")]})),_:1})]})),_:1})]})),_:1},8,["is-open"]),(0,r.Wm)((0,i.SU)(c.ki),{"is-open":z.value,onIonModalDidDismiss:x},{default:(0,r.w5)((function(){return[(0,r.Wm)((0,i.SU)(c.W2),null,{default:(0,r.w5)((function(){return[(0,r.Wm)((0,i.SU)(c.x4),{"display-format":"DD/MM/YYYY","picker-format":"DD/MM/YYYY",modelValue:g.value,"onUpdate:modelValue":e[7]||(e[7]=function(n){return g.value=n}),onIonChange:x},null,8,["modelValue"]),(0,r.Wm)((0,i.SU)(c.YG),{expand:"block",onClick:x},{default:(0,r.w5)((function(){return[(0,r.Uk)("Tutup")]})),_:1})]})),_:1})]})),_:1},8,["is-open"]),(0,r.Wm)((0,i.SU)(c.Px),{"is-open":W.value.isOpen,message:W.value.message,duration:W.value.duration,color:W.value.color,onDidDismiss:e[8]||(e[8]=function(){return W.value.isOpen=!1})},null,8,["is-open","message","duration","color"])]})),_:1})]})),_:1})}}},U=p,v=U}}]);
//# sourceMappingURL=838.ba1f71c7.js.map